<!DOCTYPE html>
<html lang="ar" dir="rtl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ููุญุฉ ุชุญูู ุงูุทุจูุจ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-4">

<div class="container">
    <h2 class="mb-4">ูุฑุญุจูุง ุฏูุชูุฑ <span th:text="${doctor.fullName}"></span></h2>
    <div class="mb-3 text-end d-flex justify-content-start gap-2">
        <a href="/doctor/settings" class="btn btn-primary">โ๏ธ ุฅุนุฏุงุฏุงุช ุงูุฃุณุนุงุฑ</a>
        <a href="/doctor/add-nurse" class="btn btn-success">โ ุฅุถุงูุฉ ููุฑุถุฉ ุฌุฏูุฏุฉ</a>
    </div>

    <div class="alert alert-info text-center mb-3 d-flex justify-content-center align-items-center gap-2">
        ๐ฐ ุฅุฌูุงูู ุฅูุฑุงุฏุงุช ุงูููู:
        <strong id="revenue" th:text="'**********'"></strong>
        <button type="button" class="btn btn-outline-secondary btn-sm" id="toggleRevenue" title="ุฅุธูุงุฑ/ุฅุฎูุงุก">
            ๐๏ธ
        </button>
    </div>

    <div class="row mb-4 text-center">
        <div class="col-md-3">
            <div class="card shadow-sm border-success">
                <div class="card-body">
                    <h5 class="text-success mb-1">โ ุชู ุงููุดู</h5>
                    <h3 th:text="${doneCount}"></h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card shadow-sm border-warning">
                <div class="card-body">
                    <h5 class="text-warning mb-1">๐ ุฌุงุฑู ุงููุดู</h5>
                    <h3 th:text="${currentCount}"></h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card shadow-sm border-secondary">
                <div class="card-body">
                    <h5 class="text-secondary mb-1">โ ููุฏ ุงูุงูุชุธุงุฑ</h5>
                    <h3 th:text="${pendingCount}"></h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card shadow-sm border-danger">
                <div class="card-body">
                    <h5 class="text-danger mb-1">โ ููุบุงุฉ</h5>
                    <h3 th:text="${canceledCount}"></h3>
                </div>
            </div>
        </div>
    </div>

    <div class="alert alert-primary text-center fw-bold">
        ุฅุฌูุงูู ุงูุญุฌูุฒุงุช: <span th:text="${totalCount}"></span>
    </div>

    <div class="card shadow">
        <div class="card-header bg-primary text-white">
            <strong>ุงููุดููุงุช ุงูุฌุงุฑูุฉ</strong>
        </div>
        <div class="card-body">
            <table class="table table-hover align-middle">
                <thead class="table-primary">
                <tr>
                    <th>ุงููุฑูุถ</th>
                    <th>ุงูููุน</th>
                    <th>ุงูุดููู</th>
                    <th>ุชุงุฑูุฎ ุงูุฒูุงุฑุฉ</th>
                    <th>ุงูุฅุฌุฑุงุก</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="v : ${currentVisits}">
                    <td th:text="${v.patient.user.fullName}"></td>
                    <td th:text="${v.visitType}"></td>
                    <td th:text="${v.complaint}"></td>
                    <td th:text="${#temporals.format(v.visitDate, 'yyyy-MM-dd HH:mm')}"></td>
                    <td>
                        <a th:href="@{'/doctor/visit/' + ${v.id}}" class="btn btn-success btn-sm">ุนุฑุถ ุงููุดู</a>
                    </td>
                </tr>
                <tr th:if="${#lists.isEmpty(currentVisits)}">
                    <td colspan="5" class="text-center text-muted">ูุง ููุฌุฏ ูุดู ุฌุงุฑู ุงูุขู</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

</body>
<script th:inline="javascript">
    /*<![CDATA[*/
    const toggleBtn = document.getElementById('toggleRevenue');
    const revenueElem = document.getElementById('revenue');
    let visible = false;

    // ุฎุฒู ุงููุจูุบ ุงููุนูู ูู ุงูุณูุฑูุฑ
    const actualRevenue = /*[[${#numbers.formatDecimal(totalRevenue, 0, 'COMMA', 2, 'POINT')}]]*/ '0 ุฌ.ู';

    toggleBtn.addEventListener('click', () => {
        if (!visible) {
            revenueElem.textContent = actualRevenue;
            visible = true;
        } else {
            revenueElem.textContent = '**********';
            visible = false;
        }
    });
    /*]]>*/
</script>
</html>
