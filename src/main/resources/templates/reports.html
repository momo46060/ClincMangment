<!DOCTYPE html>
<html lang="ar" dir="rtl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø·Ø¨ÙŠØ¨ - ClinicEase</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /*
         * ======================================
         * ØªØ®ØµÙŠØµ Ø§Ù„Ø³ØªØ§ÙŠÙ„ Ù„Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ø·Ø¨ÙŠ Ø§Ù„ÙØ§Ø®Ø± (Medical Blue Reports Dashboard)
         * ======================================
         */
        :root {
            --primary-color: #007BFF;
            --primary-dark: #0056b3;
        }

        body {
            background: #f8faff; /* Ø®Ù„ÙÙŠØ© Ø¨ÙŠØ¶Ø§Ø¡ Ù…Ø²Ø±Ù‚Ø© Ù†Ø¸ÙŠÙØ© */
            font-family: 'Tajawal', sans-serif;
        }
        h2 {
            font-weight: 800;
            /* Ù„ÙˆÙ† Ø£Ø²Ø±Ù‚ Ø¯Ø§ÙƒÙ† Ù…ÙˆØ­Ø¯ */
            color: var(--primary-dark);
        }
        .card {
            border: none;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.12);
        }
        .stat-card {
            text-align: center;
            padding: 25px 20px;
            color: #fff;
            border-radius: 18px;
        }
        .stat-card h5 { font-weight: 500; opacity: 0.9; }
        .stat-card h3 { font-weight: 900; font-size: 2.2rem; }

        /* Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ù…ÙˆØ­Ø¯ */
        .bg-patients {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
        }

        /* ØªÙ… Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ù„Ù„ØªÙ…ÙŠÙŠØ² */
        .bg-appointments { background: linear-gradient(135deg, #f9a825, #fbc02d); }
        .bg-finance { background: linear-gradient(135deg, #039be5, #29b6f6); }
        .bg-performance { background: linear-gradient(135deg, #ff5722, #ff8a65); }

        .card-header {
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
            /* ØªØ¯Ø±Ø¬ Ø£Ø²Ø±Ù‚ Ù…ÙˆØ­Ø¯ Ù„Ø±Ø£Ø³ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
            padding: 1rem;
            border-bottom: none;
        }
        .card-header strong { font-size: 1.2rem; color: #fff; font-weight: 700; }
        .card-body { padding: 1.5rem; }
        canvas { background: #fff; border-radius: 16px; padding: 10px; }

        .btn-outline-danger {
            border-radius: 12px;
            font-weight: 600;
            padding: 0.5rem 1rem;
        }
    </style>
</head>
<body class="p-4">
<div class="container">

    <div class="d-flex justify-content-between align-items-center mb-5">
        <h2>ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø·Ø¨ÙŠØ¨ <span th:text="${doctor.fullName}"></span> ğŸ‘¨â€âš•ï¸</h2>
        <a href="/logout" class="btn btn-outline-danger"><i class="bi bi-box-arrow-right"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
    </div>

    <div class="row g-4 mb-5">
        <div class="col-md-3">
            <div class="stat-card bg-patients shadow-lg">
                <h5>Ø§Ù„Ù…Ø±Ø¶Ù‰ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</h5>
                <h3 th:text="${totalPatients}">0</h3>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card bg-appointments shadow-lg">
                <h5>Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</h5>
                <h3 th:text="${totalAppointments}">0</h3>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card bg-finance shadow-lg">
                <h5>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</h5>
                <h3 th:text="${totalRevenue} + ' Ø¬.Ù…'">0 Ø¬.Ù…</h3>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card bg-performance shadow-lg">
                <h5>Ù…ØªÙˆØ³Ø· Ù…Ø¯Ø© Ø§Ù„ÙƒØ´Ù</h5>
                <h3 th:text="${averageConsultationTime} + ' Ø¯Ù‚ÙŠÙ‚Ø©'">0 Ø¯Ù‚ÙŠÙ‚Ø©</h3>
            </div>
        </div>
    </div>

    <div class="row g-4">
        <div class="col-md-6">
            <div class="card shadow">
                <div class="card-header"><strong>ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø±Ø¶Ù‰ Ø­Ø³Ø¨ Ø§Ù„Ø¹Ù…Ø±</strong></div>
                <div class="card-body">
                    <canvas id="patientsAgeChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card shadow">
                <div class="card-header"><strong>Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø© Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ù…Ù„ØºØ§Ø©</strong></div>
                <div class="card-body">
                    <canvas id="appointmentsStatusChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card shadow">
                <div class="card-header"><strong>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø·Ø¨ÙŠØ¨</strong></div>
                <div class="card-body">
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card shadow">
                <div class="card-header"><strong>Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</strong></div>
                <div class="card-body">
                    <canvas id="staffPerformanceChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<script th:inline="javascript">
    /*<![CDATA[*/
    // Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ‡Ù…ÙŠØ© ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø·Ù‡Ø§ Ø¨Ø§Ù„Ù€ Controller
    const patientsAgeData = /*[[${patientsAgeData}]]*/ [5,10,15,20,25,30];
    const appointmentsStatusData = /*[[${appointmentsStatusData}]]*/ [50,10];
    const revenueData = /*[[${revenueData}]]*/ [5000,7000,3000];
    const staffPerformanceData = /*[[${staffPerformanceData}]]*/ [80,70,90];

    // Chart.js

    // Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ÙˆØ­Ø¯Ø©
    const primaryBlue = 'var(--primary-color)'; // #007BFF
    const dangerRed = '#e53935'; // Ø£Ø­Ù…Ø± Ø«Ø§Ø¨Øª Ù„Ù„Ø¥Ù„ØºØ§Ø¡
    const financeBlue = '#039be5';
    const performanceOrange = '#ff5722';

    new Chart(document.getElementById('patientsAgeChart'), {
        type: 'bar',
        data: {
            labels: ['0-10','11-20','21-30','31-40','41-50','51+'],
            datasets: [{
                label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø¶Ù‰',
                data: patientsAgeData,
                // ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ù…ÙˆØ­Ø¯
                backgroundColor: primaryBlue
            }]
        },
        options: { responsive:true, plugins:{legend:{display:false}} }
    });

    new Chart(document.getElementById('appointmentsStatusChart'), {
        type: 'doughnut',
        data: {
            labels: ['Ù…ÙƒØªÙ…Ù„Ø©','Ù…Ù„ØºØ§Ø©'],
            datasets: [{
                label: 'Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯',
                data: appointmentsStatusData,
                // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† "Ù…ÙƒØªÙ…Ù„Ø©" Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ù…ÙˆØ­Ø¯
                backgroundColor: [primaryBlue, dangerRed]
            }]
        },
        options: { responsive:true }
    });

    new Chart(document.getElementById('revenueChart'), {
        type: 'bar',
        data: {
            labels: ['Ø¯ÙƒØªÙˆØ± 1','Ø¯ÙƒØªÙˆØ± 2','Ø¯ÙƒØªÙˆØ± 3'],
            datasets: [{
                label: 'Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª',
                data: revenueData,
                backgroundColor: financeBlue
            }]
        },
        options: { responsive:true }
    });

    new Chart(document.getElementById('staffPerformanceChart'), {
        type: 'bar',
        data: {
            labels: ['Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ 1','Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ 2','Ù…Ù…Ø±Ø¶Ø© 1'],
            datasets: [{
                label: 'Ø§Ù„Ø£Ø¯Ø§Ø¡ %',
                data: staffPerformanceData,
                backgroundColor: performanceOrange
            }]
        },
        options: { responsive:true, scales:{y:{beginAtZero:true,max:100}} }
    });
    /*]]>*/
</script>

</body>
</html>